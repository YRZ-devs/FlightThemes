name: upload-artifacts
on: [push]
jobs:
    Check-Files-Exist:
        uses: ./.github/workflows/validate-themes.yml
    
    Upload-Artifacts:
        runs-on: ubuntu-18.04
        needs: Check-Files-Exist
        steps:
            - name: Checkout 
              uses: actions/checkout@v3
              
            - name: Create a Temporary Directory
              run: mkdir tmp
              
            - name: Compress all Folders into Temp Directory
              run: |
                for dir in ./*/
                do
                    zip -r ./tmp/theme-${dir:2:${#dir}-3}.zip ${dir}
                done
            
            - name: Upload Archives as Releases
              uses: andelf/nightly-release@v0.0.4
              with:
                tag_name: release
                name: Themes
                body: Automated export of themes
                files: tmp/*.zip
                prerelease: false
